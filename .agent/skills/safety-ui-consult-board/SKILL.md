name: "safety-ui-consult-board"

description: "「困っています」相談のスレッド表示、回答投稿フォーム、および解決済みステータス管理機能を持つ掲示板UIコンポーネントを実装する。"

version: "1.0.0"

author: "OWLight Development Team"

tags: \["feature", "safety", "ui-component"]

triggers:

&nbsp; - "相談掲示板"

&nbsp; - "Q\&Aスレッド"

&nbsp; - "解決済みフラグ"

---



\## 概要



職員同士が助け合うための相談掲示板（Consultation Board）UIを実装します。

相談スレッドの一覧表示（フィルタリング機能付き）、個別の相談詳細画面、回答投稿フォーム、そして質問者が解決済みにするためのアクションボタンを提供します。心理的安全性を高めるため、UI上の文言は「質問」「回答」ではなく「相談」「アドバイス」といった柔らかい表現を使用します。



\## このスキルが前提とするもの



\- `safety-api-consult` スキルにより、相談APIが実装済みであること

\- UI ガイドライン（Teal #218F8D）および共通コンポーネント（Badge, Avatar, Button）が利用可能であること

\- 相対時間表示ライブラリ（date-fns 等）が導入されていること



\## 実装内容



\### UI 実装



\*\*コンポーネント：ConsultationList.tsx\*\*



\- 機能：相談スレッドの一覧表示

\- フィルタ：\[すべて] \[募集中(Open)] \[解決済み(Resolved)]

\- カード表示項目：タイトル、相談者アバター、タグ、回答数、作成日時（相対表記）

\- ステータスバッジ：Open（緑）, Resolved（グレー/チェック済み）



\*\*コンポーネント：ConsultationDetail.tsx\*\*



\- 機能：相談詳細と回答タイムラインの表示

\- ヘッダー：相談内容、ステータス変更ボタン（質問者本人のみ表示）

\- タイムライン：回答コメントのリスト表示

\- 投稿フォーム：新規回答の入力（Markdown対応推奨）



\*\*コンポーネント：StatusToggle.tsx\*\*



\- 機能：ステータスを「解決済み」に変更するボタン

\- UI：トグルスイッチまたはボタン（「解決しましたか？」の確認ダイアログ付き）

\- 動作：`PATCH /api/v1/safety/consultations/:id/status` をコール



\*\*画面レイアウト\*\*



\- 配置：2カラムレイアウト（左：一覧、右：詳細 または 画面遷移）

\- レスポンシブ：モバイルでは一覧と詳細を別画面として遷移



\### 状態管理



\- \*\*SWR / React Query\*\*: データのフェッチとキャッシュ管理（一覧のリアルタイム更新に近い体験を提供）

\- \*\*Optimistic UI\*\*: 回答投稿やステータス変更時に、即座にUIを更新して体感速度を向上させる



\## 参考資料



\- `/docs/03\_SCREEN\_DESIGN.md` （相談機能のUIワイヤーフレーム）

\- `/docs/02\_PSYCHOLOGICAL\_SAFETY\_FRAMEWORK.md` （相談の正規化に関するUX指針）

\- `/docs/05\_UI\_UX\_GUIDELINES.md` （バッジやボタンのスタイル）



\## チェックリスト



実装完了時に、以下をすべて確認：



\- \[ ] `ConsultationList.tsx` で一覧が表示され、ステータスフィルタが機能すること

\- \[ ] `ConsultationDetail.tsx` で詳細と回答一覧が表示されること

\- \[ ] 回答投稿フォームから `POST` リクエストが成功し、リストが更新されること

\- \[ ] 質問者本人が閲覧した時のみ「解決済みにする」ボタンが表示されること

\- \[ ] ステータス変更がAPIに反映され、バッジの色が変わること

\- \[ ] 「回答」ではなく「アドバイス」等の用語が使用されていること

\- \[ ] エラー時（投稿失敗等）にトースト通知が表示されること



\## 補足・注意事項



\- 解決済み（Resolved）になったスレッドでも、追加のコメント投稿を許可するかどうかは運用ポリシーによりますが、MVPでは「感謝コメント」等を送れるよう許可する設定を推奨します。

\- 「良い質問（Good Question）」ボタンの実装は、本スキル内または別途 `safety-ui-praise` スキルで実装してください（今回はボタン配置のみでも可）。

