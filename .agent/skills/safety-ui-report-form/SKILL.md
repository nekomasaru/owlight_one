name: "safety-ui-report-form"

description: "「状況・発見・道標」の3要素を入力するDiscovery Report（失敗報告）フォームを実装し、匿名性レベルの選択機能を提供する。"

version: "1.0.0"

author: "OWLight Development Team"

tags: \["feature", "safety", "ui-component"]

triggers:

&nbsp; - "失敗報告フォーム"

&nbsp; - "Discovery Report"

&nbsp; - "3ステップ入力"

---



\## 概要



心理的安全性を担保しながら失敗やトラブルを報告するための入力フォームを実装します。

「誰が悪いか」ではなく「何が起きたか（状況）」「何に気づいたか（発見）」「どうすれば回避できるか（道標）」の3要素に焦点を当てたUI設計により、報告者の心理的負担を軽減します。また、実名・半匿名・完全匿名の選択UIを提供します。



\## このスキルが前提とするもの



\- `safety-api-report` スキルにより、報告作成APIが実装済みであること

\- UI ガイドライン（Teal #218F8D）および共通フォームコンポーネント（Textarea, Select, Button）が利用可能であること

\- フォームバリデーションライブラリ（React Hook Form + Zod 等）が導入されていること



\## 実装内容



\### UI 実装



\*\*コンポーネント：DiscoveryReportForm.tsx\*\*



\- 機能：失敗報告の新規作成

\- フォーム構成（3ステップまたは1画面内のセクション分割）：

&nbsp; 1. \*\*Situation (状況)\*\*:

&nbsp;    - ラベル: 「どんな落とし穴がありましたか？」

&nbsp;    - プレースホルダー: 「手続きの解釈に誤解が生じやすい箇所があった...」

&nbsp;    - 入力: テキストエリア（必須）

&nbsp; 2. \*\*Discovery (発見)\*\*:

&nbsp;    - ラベル: 「そこから何を発見しましたか？」

&nbsp;    - プレースホルダー: 「マニュアルの第3条が実態と合っていないことに気づいた...」

&nbsp;    - 入力: テキストエリア（必須）

&nbsp; 3. \*\*Signpost (道標)\*\*:

&nbsp;    - ラベル: 「次の人はどうすれば回避できますか？」

&nbsp;    - プレースホルダー: 「事前に〇〇課へ確認を入れるフローを追加すべき...」

&nbsp;    - 入力: テキストエリア（必須）

&nbsp; 4. \*\*Anonymity (公開設定)\*\*:

&nbsp;    - ラジオボタンまたはセレクトボックス:

&nbsp;      - 実名で共有（信頼度アップ）

&nbsp;      - 管理職のみ実名（同僚には匿名）

&nbsp;      - 完全匿名（誰にもわからない）

\- 送信ボタン: 「未来への道標を立てる」（ポジティブな文言）

\- 完了演出: 送信成功時に紙吹雪（Confetti）アニメーションを表示



\*\*画面レイアウト\*\*



\- ヘッダー: 「Discovery Report - 失敗を発見に変える」

\- 色使い: 警告色（赤）を避け、学習色（オレンジ・黄色）や落ち着いたTealを使用

\- ガイド: 各入力欄に「個人の責任ではなく構造的要因を書こう」といったマイクロコピーを配置



\### 状態管理



\- \*\*React Hook Form\*\*: フォームの状態管理

\- \*\*Zod\*\*: バリデーション（各フィールドの文字数制限など）

\- \*\*送信処理\*\*: `POST /api/v1/safety/discovery` をコールし、成功時はフォームをリセットして完了画面/トーストを表示



\## 参考資料



\- `/docs/03\_SCREEN\_DESIGN.md` （3.3 Discovery Report Editor のUI仕様）

\- `/docs/01\_PRODUCT\_VISION.md` （Positive Framing の原則）

\- `/docs/05\_UI\_UX\_GUIDELINES.md` （フォームデザイン）



\## チェックリスト



実装完了時に、以下をすべて確認：



\- \[ ] `DiscoveryReportForm.tsx` が実装され、3つのテキストエリアに入力できること

\- \[ ] 匿名性レベル（3段階）が選択でき、APIリクエストに含まれること

\- \[ ] 必須項目が空の場合にバリデーションエラーが表示されること

\- \[ ] 送信ボタンのラベルが「未来への道標を立てる」等のポジティブな表現になっていること

\- \[ ] 送信成功時に紙吹雪アニメーション等のフィードバックがあること

\- \[ ] API エラー時（ネットワークエラー等）に適切なメッセージが表示されること

\- \[ ] 画面全体から「失敗を責める」ような赤色や警告アイコンが排除されていること



\## 補足・注意事項



\- 「完全匿名」を選択した際のユーザーへの注意書き（「この選択は取り消せません」「管理職からも誰が書いたか分からなくなります」等）を明記し、安心感と責任のバランスを取ってください。

\- 入力中の離脱を防ぐため、`useBeforeUnload` フック等の導入も検討してください。

