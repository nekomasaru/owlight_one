name: "admin-ui-user-list"

description: "登録済みユーザーを一覧表示し、検索・フィルタリングおよびロール（権限）の変更を行うための管理者専用UIを実装する。"

version: "1.0.0"

author: "OWLight Development Team"

tags: \["feature", "admin-console", "ui-component"]

triggers:

&nbsp; - "ユーザー管理"

&nbsp; - "User List"

&nbsp; - "権限変更"

---



\## 概要



管理者（Admin）が組織内の全ユーザーを管理するための画面を実装します。

ユーザー情報の検索や並び替えが可能なデータテーブルを表示し、特定のユーザーに対して「Manager（管理職）」や「Admin（システム管理者）」への昇格・降格を行う機能を提供します。誤操作を防ぐため、権限変更時には確認ダイアログを表示します。







\## このスキルが前提とするもの



\- `admin-ui-layout` スキルにより、管理者用レイアウトが利用可能であること

\- `users` テーブルにデータが存在すること

\- ユーザー一覧取得および更新用のAPI（`GET/PATCH /api/v1/admin/users`）が利用可能であること（またはSupabase Clientでの直接操作）

\- UI ガイドライン（Teal #218F8D）および共通コンポーネント（Table, Badge, Dialog）が利用可能であること



\## 実装内容



\### UI 実装



\*\*コンポーネント：UserListTable.tsx\*\*



\- \*\*機能\*\*: ユーザー一覧のデータテーブル表示

\- \*\*データ取得\*\*: SWR等を使用し、`GET /api/v1/admin/users?page=1\&query=...` から取得。

\- \*\*カラム構成\*\*:

&nbsp; - \*\*User\*\*: アバター + 表示名 + メールアドレス。

&nbsp; - \*\*Role\*\*: 現在のロール（バッジ表示：Admin=赤, Manager=青, General=緑）。

&nbsp; - \*\*Joined\*\*: 登録日 (`YYYY/MM/DD`)。

&nbsp; - \*\*Status\*\*: アクティブ/停止中。

&nbsp; - \*\*Actions\*\*: 「編集（ペンアイコン）」ボタン。

\- \*\*機能\*\*:

&nbsp; - \*\*検索バー\*\*: 名前やメールアドレスでのフィルタリング。

&nbsp; - \*\*ページネーション\*\*: 次のページ/前のページへの遷移。



\*\*コンポーネント：RoleChangeDialog.tsx\*\*



\- \*\*機能\*\*: ロール変更の確認と実行

\- \*\*Props\*\*: `isOpen`, `targetUser`, `onClose`, `onSave`

\- \*\*UI要素\*\*:

&nbsp; - 現在のロールと変更後のロールを選択するセレクトボックス。

&nbsp; - 注意書き（「管理者にするとシステム設定にアクセス可能になります」等）。

&nbsp; - 「変更を保存」ボタン。



\*\*画面レイアウト\*\*



\- 配置: 管理者コンソールの「User Management」ページ。

\- レスポンシブ: モバイルでは主要カラム（User, Role, Action）のみ表示し、詳細はドロワー等で表示するレスポンシブテーブル（Responsive Table）パターンを採用。



\## 参考資料



\- `/docs/03\_SCREEN\_DESIGN.md` （ユーザー管理画面のデザイン）

\- `/docs/04\_API\_SPECIFICATION.md` （管理者用APIの仕様）

\- `/docs/05\_UI\_UX\_GUIDELINES.md` （テーブルとバッジのスタイル）



\## チェックリスト



実装完了時に、以下をすべて確認：



\- \[ ] `UserListTable.tsx` でユーザー一覧が表示されること

\- \[ ] ページネーションと検索機能が正しく動作すること

\- \[ ] Roleカラムに適切な色のバッジが表示されていること

\- \[ ] 「編集」ボタンで `RoleChangeDialog.tsx` が開き、ロールを変更できること

\- \[ ] 変更確定時にAPIリクエストが送信され、テーブルが更新されること

\- \[ ] 自分自身の権限を誤って剥奪しようとした場合に警告またはブロックすること

\- \[ ] データ読み込み中（Loading）のスケルトン表示



\## 補足・注意事項



\- 権限変更はセキュリティリスクを伴うため、操作ログ（Audit Log）に残すことが望ましいですが、本スキルではUI実装に留めます。

\- 一般ユーザー（General）がこの画面のURLに直接アクセスした場合、`admin-ui-layout` 側またはページコンポーネント側で403エラー（またはリダイレクト）になることを確認してください。

