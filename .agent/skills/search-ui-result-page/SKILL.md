name: "search-ui-result-page"

description: "統合検索APIを利用し、検索結果のリスト表示、フィルタリング、ページネーション機能を持つ検索結果ページを実装する。"

version: "1.0.0"

author: "OWLight Development Team"

tags: \["feature", "search-experience", "ui-component"]

triggers:

&nbsp; - "検索結果画面"

&nbsp; - "Search Page"

&nbsp; - "統合検索UI"

---



\## 概要



ユーザーが検索バーから遷移した後に表示される「統合検索結果ページ（`/search`）」を実装します。

`search-api-unified` API から取得したデータを元に、AIによる回答（もしあれば）と、ドキュメントやナレッジの検索ヒット一覧を表示します。また、サイドバーには「日付」「タグ」「信頼度（Trust Tier）」による絞り込みフィルタを配置し、目的の情報に素早く到達できるUIを提供します。







\## このスキルが前提とするもの



\- `search-api-unified` スキルにより、検索API (`GET /api/v1/search`) が実装済みであること

\- UI ガイドライン（Teal #218F8D）および共通コンポーネント（Card, Badge, Skeleton）が利用可能であること

\- `search-ui-bar` が実装され、ヘッダーからクエリパラメータ付きで遷移できる状態であること



\## 実装内容



\### UI 実装



\*\*コンポーネント：SearchPage.tsx\*\*



\- \*\*機能\*\*: 検索結果画面のメインレイアウト

\- \*\*ロジック\*\*:

&nbsp; - URLクエリパラメータ（`q`, `page`, `filters`）を取得。

&nbsp; - SWR 等で API をコールし、データを取得。

\- \*\*レイアウト\*\*:

&nbsp; - \*\*Left Column\*\*: `SearchFilters`（フィルタリング用サイドバー）。

&nbsp; - \*\*Main Column\*\*: `SearchResultsList`（結果リスト）。



\*\*コンポーネント：SearchResultsList.tsx\*\*



\- \*\*機能\*\*: 検索結果のレンダリング

\- \*\*要素\*\*:

&nbsp; - \*\*AI Answer Box\*\*: 検索結果トップにAIの要約回答がある場合に表示（目立つ枠線付き）。

&nbsp; - \*\*Result Items\*\*: 個別の検索結果カードのリスト。

&nbsp; - \*\*Pagination\*\*: ページ送りUI。

&nbsp; - \*\*Empty State\*\*: 結果が0件の場合の表示。単なるメッセージだけでなく、「\*\*『{query}』についてナレッジを作成する\*\*」ボタンを表示し、作成画面へ誘導する（Search First）。



\*\*コンポーネント：SearchResultItem.tsx\*\*



\- \*\*機能\*\*: 個別の検索結果表示

\- \*\*Props\*\*: `result: { title, snippet, url, metadata, trust\_tier }`

\- \*\*デザイン\*\*:

&nbsp; - タイトル（リンク）、スニペット（マッチした部分を太字）、メタデータ（作成日、作成者）。

&nbsp; - `trust\_tier` に応じたバッジ（Gold/Silver/Bronze）を表示。



\*\*コンポーネント：SearchFilters.tsx\*\*



\- \*\*機能\*\*: 絞り込み条件の操作

\- \*\*項目\*\*:

&nbsp; - \*\*期間\*\*: 「すべて」「過去24時間」「過去1週間」「過去1ヶ月」。

&nbsp; - \*\*種類\*\*: 「ナレッジ」「ドキュメント（PDF）」「チャットログ」。

&nbsp; - \*\*タグ\*\*: 人気のタグリスト。



\## 参考資料



\- `/docs/03\_SCREEN\_DESIGN.md` （検索結果画面のワイヤーフレーム）

\- `/docs/05\_UI\_UX\_GUIDELINES.md` （リスト表示とハイライトのスタイル）

\- `/docs/04\_API\_SPECIFICATION.md` （検索APIのレスポンス定義）



\## チェックリスト



実装完了時に、以下をすべて確認：



\- \[ ] `/search?q=キーワード` でアクセスした際に、APIから結果が取得・表示されること

\- \[ ] 検索結果のタイトル、スニペット、リンクが正しくレンダリングされること

\- \[ ] AI回答（Answer）が含まれる場合、最上部に強調表示されること

\- \[ ] サイドバーのフィルタを操作すると、APIリクエストパラメータが更新され結果が変わること

\- \[ ] ページネーションが機能し、次ページの結果が読み込まれること

\- \[ ] 検索結果がない場合（0件）、適切なメッセージとイラストが表示されること
\- \[ ] 検索結果がない場合（0件）、作成画面へのリンクボタンが表示され、クリック時にクエリ（タイトル）が引き継がれること

\- \[ ] データ読み込み中（Loading）にスケルトンUIが表示されること

\- \[ ] モバイル端末ではフィルタエリアがアコーディオンまたはドロワーとして表示されること



\## 補足・注意事項



\- 検索キーワードのハイライト（太字表示）は、API側で処理済みのHTMLスニペットが返る場合と、フロントエンドで処理する場合がありますが、XSS対策（`dangerouslySetInnerHTML` の適切な使用または置換ロジック）を忘れずに行ってください。

\- 検索結果ページはユーザーの離脱を防ぐ重要な画面です。読み込み速度（LCP）を意識し、画像などの遅延読み込みを適切に設定してください。

